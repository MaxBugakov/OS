# ИДЗ 4
## Бугаков Максим БПИ226
## Вариант 5
**ИДЗ выполнено на 8 балов**
## Условие
Задача о читателях и писателях. Базу данных, представленную массивом целых положительных чисел, разделяют два типа
процессов: N читателей и K писателей. Читатели периодически
просматривают случайные записи базы данных и выводя номер
свой номер (например, PID), индекс записи, ее значение, а также вычисленное значение числа Фибоначчи. Писатели изменяют случайные записи на случайное число и также выводят информацию о
своем номере, индексе записи, старом значении и новом значении.
Предполагается, что в начале БД находится в непротиворечивом
состоянии (все числа отсортированы, например, по возрастанию).
Каждая отдельная новая запись переводит БД из одного непротиворечивого состояния в другое (то есть, новая сортировка может
поменять индексы записей или переставить числа). Для предотвращения взаимного влияния транзакций процесс–писатель должен
иметь исключительный доступ к БД. Если к БД не обращается
ни один из процессов–писателей, то выполнять транзакции могут
одновременно сколько угодно читателей.
Создать клиент–серверное приложение с процессами–писателями и процессами–читателями.
Сервер моделирует базу данных. Все писатели и все читатели —
два разных клиента, в каждом из которых возможна конкуренция параллельных процессов или потоков. Каждый процесс —
это отдельный писатель или отдельный читатель внутри сервера.

## На 4-5 баллов:
### Алгоритмы и структуры данных:
 - **Структура Базы Данных:**

   - База данных представлена массивом целых положительных чисел database. Изначально все числа в массиве отсортированы по возрастанию.
- **Синхронизация:**
  - Мьютекс `pthread_mutex_t db_mutex` для исключительного доступа писателей к базе данных.
  - Семафор `sem_t db_sem` для координации доступа читателей к базе данных.

### Файлы и их содержание:
1. server.c:
    - Инициализация базы данных.
    - Создание сокета и ожидание подключений.
    - Обработка запросов от клиентов (читателей и писателей).
    - Синхронизация доступа к базе данных.
2. reader.c:
    - Подключение к серверу.
    - Запрос случайной записи из базы данных.
    - Отображение информации о записи и вычисление числа Фибоначчи.
3. writer.c:
    - Подключение к серверу.
    - Изменение случайной записи в базе данных.
    - Отображение старого и нового значения записи.

### Сценарий клиент-серверного приложения:
 - Сервер запускается и ожидает подключения клиентов.
 - Клиенты-читатели и клиенты-писатели запускаются независимо и могут подключаться к серверу с использованием сокетов и протокола UDP.
 - Параллельное выполнение клиентов обеспечивается использованием процессов или потоков.

[Скриншот работы программы](grade_4-5/screenshot.jpg)
### Инструкция по запуску:
1. **Компиляция:** `gcc server.c -o server -lpthread`,`gcc reader.c -o reader`,`gcc writer.c -o writer`
2. **Запуск сервера:** `./server`
3. **Запуск клиентов:**
    - **Клиент-читатель:** `./reader <index>`
    - **Клиент-писатель:** `./writer <index> <new_value>`
  
## На 6-7 баллов:
### Алгоритмы и структуры данных:
 - **Структура Базы Данных:**
   - Используются те же структуры и механизмы синхронизации, что и для решения на 4-5 баллов.
- **Клиент-наблюдатель:**
  - Новый клиент, который подключается к серверу и отображает комплексную информацию о выполнении приложения в целом.

### Файлы и их содержание:
1. server.c:
    - Так же, как в решении на 4-5 баллов.
    - Обработка запросов от клиентов (читателей, писателей и наблюдателей).
    - Отправка данных клиенту-наблюдателю.
2. reader.c:
    - Так же, как в решении на 4-5 баллов.
3. writer.c:
    - Так же, как в решении на 4-5 баллов.
4. observer.c:
    - Подключение к серверу.
    - Получение и отображение комплексной информации о выполнении приложения.

### Сценарий клиент-серверного приложения:
 - Сервер обрабатывает запросы от клиентов-читателей и клиентов-писателей, а также отправляет данные клиенту-наблюдателю.
 - Клиент-наблюдатель собирает данные о всех транзакциях и отображает их в интегрированном виде.

[Скриншот работы программы](grade_6-7/screenshot.jpg)
### Инструкция по запуску:
1. **Компиляция:** `gcc server.c -o server -lpthread`,`gcc reader.c -o reader`,`gcc writer.c -o writer`, `gcc observer.c -o observer`
2. **Запуск сервера:** `./server`
3. **Запуск клиентов:**
    - **Клиент-читатель:** `./reader <index>`
    - **Клиент-писатель:** `./writer <index> <new_value>`
    - **Клиент-наблюдателя:** `./observer`
  
## На 8 баллов:
### Алгоритмы и структуры данных:
 - **Структура Базы Данных:**
   - Используются те же структуры и механизмы синхронизации, что и для решения на 4-5 баллов.
- **Множество Клиентов-наблюдателей:**
  - Добавлен список клиентов-наблюдателей с поддержкой динамического подключения и отключения.
  - Сервер отправляет данные обо всех транзакциях всем активным наблюдателям.

### Файлы и их содержание:
Всё осталось так же, добавилось только:
 - **server.c:** Отправка данных всем активным наблюдателям.
 - **observer.c:** Поддержка динамического подключения и отключения клиентов-наблюдателей.

### Сценарий клиент-серверного приложения:
 - Сервер обрабатывает запросы от клиентов-читателей и клиентов-писателей, а также отправляет данные всем подключенным клиентам-наблюдателям.
 - Клиенты-наблюдатели могут динамически подключаться и отключаться, получая информацию от сервера без нарушения работы приложения.

[Скриншот работы программы](grade_8/screenshot.png)
### Инструкция по запуску:
Так же, как в решении на 6-7 баллов.
  

  
