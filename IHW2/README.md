# ИДЗ 2
## Бугаков Максим БПИ226
## Вариант 5
**ИДЗ выполнено на 8 балов**
## Условие
Задача о читателях и писателях. Базу данных, представленную массивом целых положительных чисел, разделяют два типа
процессов: N читателей и K писателей. Читатели периодически
просматривают случайные записи базы данных и выводя номер
свой номер (например, PID), индекс записи, ее значение, а также
вычисленное значение числа Фибоначчи. Писатели изменяют случайные записи на случайное число и также выводят информацию о
своем номере, индексе записи, старом значении и новом значении.
Предполагается, что в начале БД находится в непротиворечивом
состоянии (все числа отсортированы, например, по возрастанию).
Каждая отдельная новая запись переводит БД из одного непротиворечивого состояния в другое (то есть, новая сортировка может
поменять индексы записей или переставить числа). Для предотвращения взаимного влияния транзакций процесс–писатель должен
иметь исключительный доступ к БД. Если к БД не обращается
ни один из процессов–писателей, то выполнять транзакции могут
одновременно сколько угодно читателей.

## На 4-5 баллов:
### Сценарий решаемой задачи:
**Инициализация:**
- Создается массив целых чисел.
- Инициализируются именованные POSIX семафоры для синхронизации доступа к разделяемой памяти.

**Читатели:**
- Читатели периодически выбирают случайную запись из массива.
- Выводят информацию о своем процессе (PID), индексе записи, ее значении и вычисленном числе Фибоначчи.
- Используют семафор для обеспечения взаимного исключения при доступе к записи.

**Писатели:**
- Писатели периодически выбирают случайную запись из массива.
- Изменяют ее значение на случайное число.
- Выводят информацию о своем процессе (PID), индексе записи, старом значении и новом значении.
- Используют семафор для обеспечения эксклюзивного доступа к записи.

**Завершение программы:**
- Удаление семафоров и освобождение разделяемой памяти.

### Инструкция по запуску:
1. **Компиляция:** `gcc -o main main.c -pthread`
2. **Запуск:** `./main <количество читателей> <количество писателей>`

## На 6-7 баллов:
Всё так же, как и в решении на 4-5 баллов, только используются неименованные семафоры **UNIX SYSTEM V**, и с помощью разделяемой памяти родительский и дочерние процессы обмениваются данными.

### Инструкция по запуску:
Всё так же, как и в решении на 4-5 баллов.


## На 8 баллов:
### Разделил программу на три части:
1. Программа для инициализации и управления памятью и семафорами (init.c).
2. Программа для читателей (reader.c).
3. Программа для писателей (writer.c).

### Инструкция по запуску:
1. **Сначала нужно запустить init для инициализации разделяемой памяти и семафоров:** `gcc -o init init.c`, `./init`
2. **Затем можно запустить несколько процессов читателей и писателей:** `gcc -o reader reader.c`, `gcc -o writer writer.c`, `./reader 1 &`, `./reader 2 &`, `./reader 3 &`, `./reader 4 &`
3. **Чтобы остановить программы, можно использовать команду pkill**: `pkill reader`, `pkill writer`
4. Нажмите Enter в init для завершения и удаления семафоров и разделяемой памяти.
